# cc-obsidian-mem MCP Server Environment Variables
# Copy this file to .env and configure for your deployment

# ============================================
# REQUIRED SETTINGS
# ============================================

# Path to your Obsidian vault on the host machine
VAULT_PATH=/path/to/your/obsidian/vault

# Domain for Traefik routing (e.g., obsidian-mem.yourdomain.com)
DOMAIN=obsidian-mem.localhost

# Public URL of the MCP server (used for OAuth metadata)
RESOURCE_URL=https://obsidian-mem.yourdomain.com

# ============================================
# AUTHENTICATION SETTINGS
# ============================================

# Authentication mode: 'bearer', 'cloudflare', or 'both'
# - bearer: Simple bearer token authentication
# - cloudflare: Cloudflare Access OAuth 2.0 only
# - both: Accept either bearer token or Cloudflare Access
AUTH_MODE=both

# Bearer token for simple authentication (generate with: openssl rand -base64 32)
BEARER_TOKEN=

# ============================================
# CLOUDFLARE ACCESS (OAuth 2.0)
# ============================================

# Your Cloudflare Access team name (from Zero Trust dashboard)
# Found at: https://one.dash.cloudflare.com/ -> Settings -> Custom Pages
# Example: your-team-name (from https://your-team-name.cloudflareaccess.com)
CF_ACCESS_TEAM=

# Cloudflare Access Application Audience Tag (AUD)
# Found at: Zero Trust -> Access -> Applications -> Your App -> Overview -> Application Audience (AUD) Tag
CF_ACCESS_AUD=

# ============================================
# OPTIONAL SETTINGS
# ============================================

# Folder name within vault for memory storage (default: _claude-mem)
MEM_FOLDER=_claude-mem

# Allowed CORS origins (comma-separated)
ALLOWED_ORIGINS=https://claude.ai

# Traefik certificate resolver name (default: letsencrypt)
CERT_RESOLVER=letsencrypt

# Timezone
TZ=America/New_York

# ============================================
# CLOUDFLARE ACCESS SETUP GUIDE
# ============================================
#
# 1. Go to Cloudflare Zero Trust Dashboard:
#    https://one.dash.cloudflare.com/
#
# 2. Create an Access Application:
#    - Navigate to: Access -> Applications -> Add an application
#    - Type: Self-hosted
#    - Application name: Obsidian Memory MCP
#    - Session duration: 24 hours (or as needed)
#    - Application domain: obsidian-mem.yourdomain.com
#
# 3. Configure Policies:
#    - Add a policy for allowed users (email, group, etc.)
#    - Example: Allow emails ending in @yourdomain.com
#
# 4. Get the Application Audience (AUD) Tag:
#    - After creating, click on the application
#    - Find "Application Audience (AUD) Tag" in Overview
#    - Copy the value to CF_ACCESS_AUD
#
# 5. Get your Team Name:
#    - Go to Settings -> Custom Pages
#    - Your team domain is: https://[team-name].cloudflareaccess.com
#    - Copy [team-name] to CF_ACCESS_TEAM
#
# 6. Configure DNS:
#    - Add CNAME record pointing to your tunnel or server
#    - Ensure Cloudflare proxy is enabled (orange cloud)
#
# 7. Test the setup:
#    curl https://obsidian-mem.yourdomain.com/.well-known/oauth-protected-resource
